(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{302:function(e,t,n){},489:function(e,t,n){"use strict";n.r(t),n.d(t,"history",(function(){return Ke}));var r=n(0),i=n(54),a=n.n(i),s=(n(301),n(302),n(303),n(17)),o=n(27),c=n(509),u=n(525),l=n(528),d=n(15),j=n(14),h=n(20),b=function(){function e(){var t=this;Object(d.a)(this,e),this.mapsURL="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyD1x6I0MefjPK4su3G9W5rKmt6yBbQXvUI","&libraries=places&v=quarterly"),this.mapScriptLoaded=!1,this.mapOptions={},this.loadMapApi=function(){for(var e=document.getElementsByTagName("script"),n=0;n<e.length;n++)if(0===e[n].src.indexOf(t.mapsURL))return e[n];var r=document.createElement("script");return r.src=t.mapsURL,r.async=!0,r.defer=!0,window.document.body.appendChild(r),t.mapScriptLoaded=!0,r},this.initMap=function(e){e.current&&new google.maps.Map(e.current,t.mapOptions)},this.setMapOptions=function(e,n){t.mapOptions={zoom:e,center:n,mapTypeControl:!0,scaleControl:!0,fullscreenControl:!0,zoomControl:!0,gestureHandling:"cooperative",mapTypeId:google.maps.MapTypeId.ROADMAP,draggableCursor:"pointer"}},Object(j.d)(this)}return Object(h.a)(e,[{key:"setCoordinates",value:function(e){var t=+e.latLong.split(",")[0].split(":")[1],n=+e.latLong.split(",")[1].split(":")[1];return new google.maps.LatLng(t,n)}}]),e}(),p=n(19),g=n.n(p),f=n(30),m=n(221),O=n(73),x=n.n(O),v=function e(t,n){Object(d.a)(this,e),this.data=void 0,this.pagination=void 0,this.data=t,this.pagination=n},k=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;Object(d.a)(this,e),this.pageNumber=void 0,this.pageSize=void 0,this.pageNumber=t,this.pageSize=n};x.a.defaults.baseURL="/api",x.a.interceptors.request.use((function(e){var t=E.commonStore.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e})),x.a.interceptors.response.use(function(){var e=Object(f.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:if(!(n=t.headers.pagination)){e.next=7;break}return t.data=new v(t.data,JSON.parse(n)),e.abrupt("return",t);case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t=e.response,n=t.data,r=t.status,i=t.config,a=t.headers;switch(r){case 400:if("string"===typeof n&&console.log(n),"get"===i.method&&n.errors.hasOwnProperty("id")&&Ke.push("not-found"),n.errors){var s=[];for(var o in n.errors)n.errors[o]&&s.push(n.errors[o]);throw s.flat()}break;case 401:401===r&&a["www-authenticate"].startsWith('Bearer error="invalid_token"')&&(E.userStore.logout(),console.log("session expired - please login again")),console.log("unauthorized");break;case 404:console.log("unauthorized"),Ke.push("/not-found");break;case 500:E.commonStore.setServerError(n),console.log(n),Ke.push("/server-error")}return Promise.reject(e)}));var L=function(e){return e.data},y=function(e){return x.a.get(e).then(L)},S=function(e,t){return x.a.post(e,t).then(L)},w=function(e,t){return x.a.put(e,t).then(L)},V=function(e){return x.a.delete(e).then(L)},P={Parks:{getAll:function(e){return x.a.get("/parks",{params:e}).then(L)},get:function(e){return y("/parks/".concat(e))}},Users:{current:function(){return y("/user")},login:function(e){return S("/user/login",e)},register:function(e){return S("/user/register",e)},refreshToken:function(){return S("/user/refreshToken",{})}},VisitedParks:{getVisited:function(){return y("/userparks/")},addVisited:function(e){return w("/userparks/".concat(e),{})},removeVisited:function(e){return V("/userparks/".concat(e))}},VisitLogs:{getVisitLogs:function(){return y("/visitlog/")},getVisitLog:function(e){return y("/visitlog/".concat(e))},addVisitLog:function(e,t){return S("/visitlog/".concat(e),t)},editVisitLog:function(e){return w("/visitlog/".concat(e.id),e)},removeVisitLog:function(e){return V("/visitlog/".concat(e))}}},C=function(){function e(){var t=this;Object(d.a)(this,e),this.currentPark=void 0,this.allParkMap=new Map,this.currentParkImageMap=new Map,this.loadingInitial=!1,this.pagination=null,this.pagingParams=new k,this.setLoadingInitial=function(e){t.loadingInitial=e},this.loadParks=Object(f.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setLoadingInitial(!0),e.prev=1,e.next=4,P.Parks.getAll(t.axiosParams);case 4:(n=e.sent).data.forEach((function(e){t.setPark(e)})),t.setPagination(n.pagination),t.setLoadingInitial(!1),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),t.setLoadingInitial(!1);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),this.loadPark=function(){var e=Object(f.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.getPark(n))){e.next=7;break}return t.currentPark=r,t.currentParkImageMap.set(r.id,0),e.abrupt("return",r);case 7:return t.loadingInitial=!0,e.prev=8,e.next=11,P.Parks.get(n);case 11:return r=e.sent,t.setPark(r),Object(j.h)((function(){t.currentPark=r,void 0!==t.currentPark&&t.currentParkImageMap.set(t.currentPark.id,0)})),t.setLoadingInitial(!1),e.abrupt("return",r);case 18:e.prev=18,e.t0=e.catch(8),console.log(e.t0),t.setLoadingInitial(!1);case 22:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}(),this.getPark=function(e){return t.allParkMap.get(e)},this.setPark=function(e){t.allParkMap.set(e.id,e),t.currentParkImageMap.set(e.id,0)},this.getCurrentImage=function(e){return t.currentParkImageMap.has(e)?t.currentParkImageMap.get(e):0},this.updateCurrentImage=function(e){var n=t.getPark(e);if(n&&0!==n.images.length){var r=((t.getCurrentImage(e)||0)+1)%n.images.length;t.currentParkImageMap.set(e,r)}},this.clearPark=function(){t.currentPark=void 0},this.setPagination=function(e){t.pagination=e},this.setPagingParams=function(e){t.pagingParams=e},Object(j.d)(this),this.loadParks()}return Object(h.a)(e,[{key:"allParks",get:function(){return Array.from(this.allParkMap)}},{key:"axiosParams",get:function(){var e=new URLSearchParams;return e.append("pageNumber",this.pagingParams.pageNumber.toString()),e.append("pageSize",this.pagingParams.pageSize.toString()),e}}]),e}(),M=function(){function e(){var t=this;Object(d.a)(this,e),this.user=null,this.visitedParksMap=new Map,this.loadingVisitedList=!1,this.loadingButtons=!1,this.refreshTokenTimeout=void 0,this.login=function(){var e=Object(f.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.Users.login(n);case 3:r=e.sent,E.commonStore.setToken(r.token),t.startRefreshTokenTimer(r),Object(j.h)((function(){t.user=r,t.setVisitedParks()})),Ke.push("/parks"),E.modalStore.closeModal(),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){E.commonStore.setToken(null),window.localStorage.removeItem("jwt"),t.user=null,t.visitedParksMap.clear(),Ke.push("/")},this.getUser=Object(f.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.Users.current();case 3:n=e.sent,E.commonStore.setToken(n.token),Object(j.h)((function(){return t.user=n})),t.startRefreshTokenTimer(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.register=function(){var e=Object(f.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.Users.register(n);case 3:r=e.sent,E.commonStore.setToken(r.token),Object(j.h)((function(){return t.user=r})),t.startRefreshTokenTimer(r),Ke.push("/parks"),E.modalStore.closeModal(),e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),this.refreshToken=Object(f.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopRefreshTokenTimer(),e.prev=1,e.next=4,P.Users.refreshToken();case 4:n=e.sent,Object(j.h)((function(){return t.user=n})),E.commonStore.setToken(n.token),t.startRefreshTokenTimer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),this.hasVisited=function(e){return t.visitedParksMap.size>0&&t.visitedParksMap.has(e)},this.setVisitedParks=Object(f.a)(g.a.mark((function e(){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.setLoadingVisited(!0),!E.userStore.user){e.next=13;break}return e.prev=2,e.next=5,P.VisitedParks.getVisited();case 5:n=e.sent,Object(j.h)((function(){n.forEach((function(e){t.visitedParksMap.set(e.id,e.fullName)})),t.setLoadingVisited(!1)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0),t.setLoadingVisited(!1);case 13:t.setLoadingVisited(!1);case 14:case"end":return e.stop()}}),e,null,[[2,9]])}))),this.addVisitedPark=function(){var e=Object(f.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.loadingButtons=!0,!E.userStore.user||t.hasVisited(n.id)){e.next=12;break}return e.prev=2,e.next=5,P.VisitedParks.addVisited(n.id);case 5:Object(j.h)((function(){t.visitedParksMap.set(n.id,n.fullName),n.visitorCount++,t.loadingButtons=!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0),t.loadingButtons=!1;case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),this.removeVisitedPark=function(){var e=Object(f.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingButtons=!0,e.prev=1,e.next=4,P.VisitedParks.removeVisited(n.id);case 4:Object(j.h)((function(){t.visitedParksMap.delete(n.id),n.visitorCount--,t.loadingButtons=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),t.loadingButtons=!1;case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.setLoadingVisited=function(e){t.loadingVisitedList=e},Object(j.d)(this)}return Object(h.a)(e,[{key:"isLoggedIn",get:function(){return!!this.user}},{key:"startRefreshTokenTimer",value:function(e){var t=JSON.parse(atob(e.token.split(".")[1])),n=new Date(1e3*t.exp).getTime()-Date.now()-6e4;this.refreshTokenTimeout=setTimeout(this.refreshToken,n)}},{key:"stopRefreshTokenTimer",value:function(){clearTimeout(this.refreshTokenTimeout)}},{key:"allVisited",get:function(){return Array.from(this.visitedParksMap).sort((function(e,t){return e[1].localeCompare(t[1])}))}}]),e}(),I=n(25),T=function e(t){Object(d.a)(this,e),Object.assign(this,t)},D=function e(t){Object(d.a)(this,e),this.id=void 0,this.parkName="",this.title="",this.startDate=null,this.endDate=null,this.notes="",this.parkRef="",t&&(this.id=t.id,this.parkName=t.parkName,this.title=t.title,this.startDate=t.startDate,this.endDate=t.endDate,this.notes=t.notes,this.parkRef=t.parkRef)},N=function(){function e(){var t=this;Object(d.a)(this,e),this.currentVisitLog=void 0,this.visitLogMap=new Map,this.loadingVisits=!1,this.loadVisitLogs=Object(f.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingVisits=!0,e.prev=1,e.next=4,P.VisitLogs.getVisitLogs();case 4:e.sent.forEach((function(e){t.setVisitLog(e)})),t.loadingVisits=!1,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0),t.loadingVisits=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),this.loadVisitLog=function(){var e=Object(f.a)(g.a.mark((function e(n){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t.getVisitLog(n))){e.next=6;break}return t.currentVisitLog=r,e.abrupt("return",r);case 6:return t.loadingVisits=!0,e.prev=7,e.next=10,P.VisitLogs.getVisitLog(n);case 10:return r=e.sent,t.setVisitLog(r),Object(j.h)((function(){t.currentVisitLog=r,console.log(t.currentVisitLog),void 0!==t.currentVisitLog&&t.visitLogMap.set(t.currentVisitLog.id,t.currentVisitLog)})),t.loadingVisits=!1,e.abrupt("return",r);case 17:e.prev=17,e.t0=e.catch(7),console.log(e.t0),t.loadingVisits=!1;case 21:case"end":return e.stop()}}),e,null,[[7,17]])})));return function(t){return e.apply(this,arguments)}}(),this.getVisitLog=function(e){return t.visitLogMap.get(e)},this.visitLogsByPark=function(e){return Array.from(t.visitLogMap.values()).filter((function(t){var n;return t.parkRef===(null===(n=E.parkStore.getPark(e))||void 0===n?void 0:n.id)}))||[]},this.createVisitLog=function(){var e=Object(f.a)(g.a.mark((function e(n,r){var i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.VisitLogs.addVisitLog(n,r);case 3:i=new T(r),t.setVisitLog(i),Object(j.h)((function(){console.log(t.currentVisitLog),console.log(i),t.currentVisitLog=i})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.editVisitLog=function(){var e=Object(f.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.VisitLogs.editVisitLog(n);case 3:Object(j.h)((function(){if(n.id){var e=Object(I.a)(Object(I.a)({},t.getVisitLog(n.id)),n);t.visitLogMap.set(n.id,e),t.currentVisitLog=e}})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteVisitLog=function(){var e=Object(f.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingVisits=!0,e.prev=1,e.next=4,P.VisitLogs.removeVisitLog(n);case 4:Object(j.h)((function(){t.visitLogMap.delete(n),t.loadingVisits=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(j.h)((function(){t.loadingVisits=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.clearVisitLog=function(){t.currentVisitLog=void 0},Object(j.d)(this),this.loadVisitLogs()}return Object(h.a)(e,[{key:"allVisitLogs",get:function(){return Array.from(this.visitLogMap.values())}},{key:"setVisitLog",value:function(e){e.startDate=new Date(e.startDate),e.endDate=new Date(e.endDate),this.visitLogMap.set(e.id,e)}}]),e}(),E={commonStore:new function e(){var t=this;Object(d.a)(this,e),this.error=null,this.token=window.localStorage.getItem("jwt"),this.appLoaded=!1,this.setServerError=function(e){t.error=e},this.setToken=function(e){t.token=e},this.setAppLoaded=function(){t.appLoaded=!0},Object(j.d)(this),Object(j.g)((function(){return t.token}),(function(e){e?window.localStorage.setItem("jwt",e):window.localStorage.removeItem("jwt")}))},parkStore:new C,userStore:new M,modalStore:new function e(){var t=this;Object(d.a)(this,e),this.modal={open:!1,body:null},this.openModal=function(e){t.modal.open=!0,t.modal.body=e},this.closeModal=function(){t.modal.open=!1,t.modal.body=null},Object(j.d)(this)},parkCommentStore:new function e(){var t=this;Object(d.a)(this,e),this.comments=[],this.hubConnection=null,this.createHubConnection=function(e){E.parkStore.currentPark&&(t.hubConnection=(new m.a).withUrl("/parkcomments?parkId="+e,{accessTokenFactory:function(){var e;return null===(e=E.userStore.user)||void 0===e?void 0:e.token}}).withAutomaticReconnect().configureLogging(m.b.Information).build(),t.hubConnection.start().catch((function(e){return console.log("Error establishing the connection: ",e)})),t.hubConnection.on("LoadComments",(function(e){Object(j.h)((function(){e.forEach((function(e){e.createdAt=new Date(e.createdAt+"Z")})),t.comments=e}))})),t.hubConnection.on("ReceiveComment",(function(e){Object(j.h)((function(){e.createdAt=new Date(e.createdAt),t.comments.unshift(e)}))})))},this.stopHubConnection=function(){var e;null===(e=t.hubConnection)||void 0===e||e.stop().catch((function(e){return console.log("Error stopping connection: ",e)}))},this.clearComments=function(){t.comments=[],t.stopHubConnection()},this.addComment=function(){var e=Object(f.a)(g.a.mark((function e(n){var r,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.parkId=null===(r=E.parkStore.currentPark)||void 0===r?void 0:r.id,e.prev=1,e.next=4,null===(i=t.hubConnection)||void 0===i?void 0:i.invoke("SendComment",n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),Object(j.d)(this)},mapStore:new b,visitLogStore:new N},A=Object(r.createContext)(E);function F(){return Object(r.useContext)(A)}var R=n(1),z=Object(s.a)((function(){var e,t,n=F().commonStore;return Object(R.jsxs)(c.a,{children:[Object(R.jsx)(u.a,{as:"h1",content:"Server Error"}),Object(R.jsx)(u.a,{sub:!0,as:"h5",color:"red",content:null===(e=n.error)||void 0===e?void 0:e.message}),(null===(t=n.error)||void 0===t?void 0:t.details)&&Object(R.jsxs)(l.a,{children:[Object(R.jsx)(u.a,{as:"h4",content:"Stack trace",color:"teal"}),Object(R.jsx)("code",{style:{marginTop:"10px"},children:n.error.details})]})]})})),B=n(28),U=n(274),q=n.n(U),G=n(529),H=n(510),K=n(526);function J(e){var t=e.inverted,n=void 0===t||t,r=e.content,i=void 0===r?"Loading...":r;return Object(R.jsx)(K.a,{active:!0,inverted:n,children:Object(R.jsx)(H.a,{content:i})})}var W=n(24),Y=n(517),Q=n(512),X=n(523),Z=n(284),_=n(519),$=n(182),ee=n(522),te=n(29),ne=n(41),re=n(514),ie=n(279),ae=n.n(ie);function se(e){var t=Object(te.e)(e.name),n=Object(B.a)(t,3),r=n[0],i=n[1],a=n[2];return Object(R.jsxs)(re.a.Field,{error:i.touched&&!!i.error,children:[Object(R.jsx)(ae.a,Object(I.a)(Object(I.a)(Object(I.a)({},r),e),{},{selected:r.value&&new Date(r.value)||null,onChange:function(e){return a.setValue(e)}})),i.touched&&i.error?Object(R.jsx)($.a,{basic:!0,color:"red",children:i.error}):null]})}function oe(e){var t=Object(te.e)(e.name),n=Object(B.a)(t,2),r=n[0],i=n[1];return Object(R.jsxs)(re.a.Field,{error:i.touched&&!!i.error,children:[Object(R.jsx)("label",{children:e.label}),Object(R.jsx)("input",Object(I.a)(Object(I.a)({},r),e)),i.touched&&i.error?Object(R.jsx)($.a,{basic:!0,color:"red",children:i.error}):null]})}function ce(e){var t=Object(te.e)(e.name),n=Object(B.a)(t,2),r=n[0],i=n[1];return Object(R.jsxs)(re.a.Field,{error:i.touched&&!!i.error,children:[Object(R.jsx)("label",{children:e.label}),Object(R.jsx)("textarea",Object(I.a)(Object(I.a)({},r),e)),i.touched&&i.error?Object(R.jsx)($.a,{basic:!0,color:"red",children:i.error}):null]})}var ue=Object(s.a)((function(e){var t=e.park,n=e.logId,i=(Object(o.f)(),F()),a=i.visitLogStore,s=i.modalStore,c=a.createVisitLog,d=a.editVisitLog,j=a.loadVisitLog,h=Object(r.useState)(new D),b=Object(B.a)(h,2),p=b[0],g=b[1],f=ne.b({title:ne.d().required("The visit title is required"),startDate:ne.a().required("The start date is required"),endDate:ne.a().min(ne.c("startDate"),"End date can not be before Start date")});return Object(r.useEffect)((function(){"create"!==n&&j(n).then((function(e){return g(new D(e))}))}),[j,n]),Object(R.jsxs)(l.a,{clearing:!0,children:[Object(R.jsx)(u.a,{content:"Visit Details",sub:!0,color:"teal"}),Object(R.jsx)(te.d,{validationSchema:f,enableReinitialize:!0,initialValues:p,onSubmit:function(e){return function(e){if(e.id)d(e).finally((function(){return s.closeModal()}));else{var n=Object(I.a)(Object(I.a)({},e),{},{id:Object(ee.a)(),parkRef:t.id,parkName:t.fullName});c(t.id,n).finally((function(){return s.closeModal()}))}}(e)},children:function(e){var t=e.handleSubmit,n=e.isValid,r=e.isSubmitting,i=e.dirty;return Object(R.jsxs)(te.c,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(R.jsx)(oe,{name:"title",placeholder:"Title"}),Object(R.jsx)(u.a,{content:"Visit Dates",sub:!0,color:"teal"}),Object(R.jsx)(se,{placeholderText:"Start Date",name:"startDate",showFullMonthYearPicker:!0,dateFormat:"MMMM d, yyyy"}),Object(R.jsx)(se,{placeholderText:"End Date",name:"endDate",showFullMonthYearPicker:!0,dateFormat:"MMMM d, yyyy"}),Object(R.jsx)(ce,{rows:5,placeholder:"Notes",name:"notes"}),Object(R.jsx)(X.a,{disabled:r||!i||!n,loading:r,floated:"right",positive:!0,type:"submit",content:"Submit"}),Object(R.jsx)(X.a,{as:W.a,to:"/parks",onClick:function(){return s.closeModal()},floated:"right",type:"button",content:"Cancel"})]})}})]})})),le=Object(s.a)((function(e){var t=e.park,n=F(),i=n.userStore,a=n.parkStore,s=n.modalStore,o=n.visitLogStore,u=i.addVisitedPark,d=i.hasVisited,j=i.removeVisitedPark,h=i.loadingButtons,b=i.isLoggedIn,p=a.getCurrentImage,g=a.updateCurrentImage,f=o.visitLogsByPark,m=Object(r.useState)(""),O=Object(B.a)(m,2),x=O[0],v=O[1];function k(e){v(e.currentTarget.name)}return Object(R.jsxs)(l.a.Group,{children:[Object(R.jsx)(l.a,{children:Object(R.jsx)(Y.a.Group,{children:Object(R.jsx)(Y.a,{children:Object(R.jsxs)(Y.a.Content,{children:[Object(R.jsx)(Y.a.Header,{as:W.a,to:"/parks/".concat(t.id),style:{marginBottom:10},children:t.fullName}),Object(R.jsx)(Q.a,{hoverable:!0,position:"left center",trigger:Object(R.jsx)(X.a,{onClick:function(){return g(t.id)},style:{margins:"0",padding:"0"},children:Object(R.jsx)(Z.a,{src:t.images[p(t.id)||0].url,size:"huge"})}),children:Object(R.jsx)(Q.a.Content,{children:Object(R.jsxs)(_.a,{children:[Object(R.jsx)(_.a.Item,{children:t.images[p(t.id)].title}),Object(R.jsxs)(_.a.Item,{children:["Credit: ",t.images[p(t.id)||0].credit]}),Object(R.jsx)(_.a.Item,{children:Object(R.jsx)("a",{href:t.images[p(t.id)||0].url,children:t.images[0].url})})]})})}),Object(R.jsx)(Y.a.Description,{children:t.description})]})})})}),Object(R.jsxs)(l.a,{secondary:!0,clearing:!0,children:[Object(R.jsxs)($.a,{size:"medium",style:{float:"right"},children:["States: ",t.states]}),Object(R.jsxs)(c.a,{children:["Latitude: ",t.latLong.split(",")[0].split(":")[1]]}),Object(R.jsxs)(c.a,{children:["Longitude: ",t.latLong.split(",")[1].split(":")[1]]})]}),Object(R.jsxs)(l.a,{clearing:!0,children:[1===t.visitorCount?Object(R.jsxs)($.a,{size:"large",children:[t.visitorCount," user has visited this park."]}):Object(R.jsxs)($.a,{size:"large",children:[t.visitorCount," users have visited this park."]}),b?d(t.id)?Object(R.jsxs)(R.Fragment,{children:[f(t.id).length>0&&Object(R.jsx)(X.a,{name:t.id,as:W.a,to:"/visitlog/".concat(t.id),content:f(t.id).length,onClick:function(e){k(e)},style:{float:"right",color:"green"}}),Object(R.jsx)(X.a,{onClick:function(){return s.openModal(Object(R.jsx)(ue,{park:t,logId:"create"}))},icon:"plus",style:{float:"right",color:"green"}}),Object(R.jsx)(X.a,{name:t.id,loading:h&&x===t.id,disabled:h&&x===t.id,onClick:function(e){k(e),j(t)},content:"Visited",icon:"check",style:{float:"right",color:"green"}})]}):Object(R.jsx)(X.a,{name:t.id,loading:h&&x===t.id,disabled:h&&x===t.id,onClick:function(e){k(e),u(t)},content:"Not Visited",icon:"x",style:{float:"right",color:"red"}}):Object(R.jsx)(Q.a,{hoverable:!0,position:"right center",content:"Create an account to use this feature!",trigger:Object(R.jsx)(X.a,{content:"Not Visited",icon:"x",style:{float:"right",color:"red"}})})]})]},t.id)})),de=Object(s.a)((function(){var e=F().parkStore.allParks;return Object(R.jsx)(R.Fragment,{children:e.map((function(e){var t=Object(B.a)(e,2),n=t[0],r=t[1];return Object(R.jsx)(le,{park:r},n)}))})})),je=n(515),he=Object(s.a)((function(){var e=F().userStore,t=e.visitedParksMap,n=e.allVisited;return Object(R.jsx)(R.Fragment,{children:t.size>0?Object(R.jsxs)(je.a,{style:{marginLeft:10},vertical:!0,borderless:!0,children:[Object(R.jsx)(u.a,{content:"Visited Parks",textAlign:"center",style:{marginTop:10}}),n.map((function(e){return Object(R.jsx)(je.a.Item,{as:W.a,to:"/parks/".concat(e[0]),children:e[1]},e[0])}))]}):Object(R.jsx)(u.a,{content:"You have not visited any parks",textAlign:"center"})})})),be=Object(s.a)((function(){var e=F(),t=e.userStore,n=e.parkStore,i=n.loadParks,a=n.setPagingParams,s=n.pagination,o=t.getUser,c=t.setVisitedParks,u=t.loadingVisitedList,l=t.isLoggedIn,d=Object(r.useState)(!1),j=Object(B.a)(d,2),h=j[0],b=j[1];return Object(r.useEffect)((function(){null!=o&&c()}),[o,c]),l&&u?Object(R.jsx)(J,{content:"Loading Visited Parks"}):Object(R.jsx)(R.Fragment,{children:Object(R.jsxs)(G.a,{children:[Object(R.jsx)(G.a.Column,{width:"11",children:Object(R.jsx)(q.a,{pageStart:0,loadMore:function(){b(!0),a(new k(s.currentPage+1)),i().then((function(){return b(!1)}))},hasMore:!h&&!!s&&s.currentPage<s.totalPages,initialLoad:!1,children:Object(R.jsx)(de,{})})}),Object(R.jsx)(G.a.Column,{width:"5",children:Object(R.jsx)(he,{})}),Object(R.jsx)(G.a.Column,{width:10,children:Object(R.jsx)(H.a,{active:h})})]})})})),pe=n(516),ge=n(518),fe=Object(s.a)((function(e){var t=e.parkId,n=F().parkCommentStore;return Object(r.useEffect)((function(){return t&&n.createHubConnection(t),function(){n.clearComments()}}),[n,t]),Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(l.a,{textAlign:"left",attached:"top",inverted:!0,color:"grey",style:{border:"none"},children:Object(R.jsx)(u.a,{children:"Comments"})}),Object(R.jsxs)(l.a,{attached:!0,clearing:!0,children:[Object(R.jsx)(te.d,{onSubmit:function(e,t){var r=t.resetForm;return n.addComment(e).then((function(){return r()}))},initialValues:{body:""},validationSchema:ne.b({body:ne.d().required()}),children:function(e){var t=e.isSubmitting,n=e.isValid,r=e.handleSubmit;return Object(R.jsx)(te.c,{className:"ui form",children:Object(R.jsx)(te.b,{name:"body",children:function(e){return Object(R.jsxs)("div",{style:{position:"relative"},children:[Object(R.jsx)(H.a,{active:t}),Object(R.jsx)("textarea",Object(I.a)(Object(I.a)({placeholder:"Enter your comment (Enter to submit, SHIFT + enter for new line)",rows:2},e.field),{},{onKeyPress:function(e){"Enter"===e.key&&e.shiftKey||"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n&&r())}}))]})}})})}}),Object(R.jsx)(pe.a.Group,{children:n.comments.map((function(e){return Object(R.jsx)(pe.a,{children:Object(R.jsxs)(pe.a.Content,{children:[Object(R.jsx)(pe.a.Author,{children:e.displayName}),Object(R.jsx)(pe.a.Metadata,{children:Object(R.jsx)("div",{children:Object(ge.a)(e.createdAt)})}),Object(R.jsx)(pe.a.Text,{children:e.body})]})},e.id)}))})]})]})})),me=Object(s.a)((function(e){var t=e.park,n=F().mapStore,i=n.initMap,a=n.setMapOptions,s=n.setCoordinates,o=Object(r.useRef)(null);return Object(r.useEffect)((function(){a(11,s(t)),i(o)}),[i,a,s,t]),Object(R.jsx)("div",{className:"map-container",ref:o})})),Oe=Object(s.a)((function(){var e=F(),t=e.parkStore,n=e.mapStore,i=t.currentPark,a=t.loadingInitial,s=t.loadPark,c=n.mapScriptLoaded,u=Object(o.h)().id;return Object(r.useEffect)((function(){u&&s(u)}),[u,s]),a||!i?Object(R.jsx)(J,{content:"Loading Park."}):Object(R.jsxs)(G.a,{children:[Object(R.jsxs)(G.a.Column,{width:10,children:[Object(R.jsx)(le,{park:i}),Object(R.jsx)(fe,{parkId:i.id})]}),Object(R.jsx)(G.a.Column,{width:6,children:c&&Object(R.jsx)(me,{park:i})})]})})),xe=n(511),ve=n(491),ke=Object(s.a)((function(e){var t=e.visitLog,n=(Object(o.f)(),F()),i=n.modalStore,a=n.parkStore,s=n.visitLogStore,d=s.deleteVisitLog,j=s.loadingVisits,h=a.currentPark,b=Object(r.useState)(""),p=Object(B.a)(b,2),g=p[0],f=p[1];return Object(R.jsxs)(l.a.Group,{children:[Object(R.jsxs)(l.a,{clearing:!0,children:[Object(R.jsx)(u.a,{as:W.a,to:"/visitlog/".concat(t.parkRef),style:{marginBottom:10},children:t.title}),Object(R.jsx)(X.a,{name:t.id,loading:j&&g===t.id,onClick:function(e){!function(e){f(e.currentTarget.name)}(e),d(t.id)},color:"red",icon:"x",floated:"right"}),Object(R.jsx)(X.a,{onClick:function(){return i.openModal(Object(R.jsx)(ue,{park:h,logId:t.id}))},icon:"edit",color:"blue",floated:"right"})]}),Object(R.jsxs)(l.a,{secondary:!0,clearing:!0,children:[Object(R.jsx)($.a,{as:W.a,to:"/parks/".concat(t.parkRef),style:{marginBottom:10},children:t.parkName}),Object(R.jsxs)(c.a,{children:["Start Date: ",Object(ve.default)(t.startDate,"dd MMM yyyy")]}),Object(R.jsxs)(c.a,{children:["End Date: ",Object(ve.default)(t.endDate,"dd MMM yyyy")]})]}),Object(R.jsx)(l.a,{children:Object(R.jsx)(c.a,{children:t.notes})})]})})),Le=Object(s.a)((function(){var e=F().visitLogStore.allVisitLogs;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(u.a,{as:"h1",content:"All Visits",textAlign:"center"}),Object(R.jsx)(xe.a,{}),e.map((function(e){return Object(R.jsx)(ke,{visitLog:e},e.id)}))]})})),ye=n(524),Se=Object(s.a)((function(e){var t=e.user,n=F(),r=n.userStore,i=(n.parkStore.allParkMap,r.allVisited);return Object(R.jsx)(l.a,{children:Object(R.jsxs)(G.a,{children:[Object(R.jsx)(G.a.Column,{width:12,children:Object(R.jsx)(Y.a.Group,{children:Object(R.jsx)(Y.a,{children:Object(R.jsx)(Y.a.Content,{verticalAlign:"middle",children:Object(R.jsx)(u.a,{as:"h1",content:t.displayName})})})})}),Object(R.jsx)(G.a.Column,{width:4,children:Object(R.jsxs)(ye.a,{children:[Object(R.jsx)(ye.a.Value,{children:i.length}),Object(R.jsx)(ye.a.Label,{children:"Parks Visited"})]})})]})})})),we=Object(s.a)((function(){var e=F().userStore.user;return Object(R.jsx)(G.a,{children:Object(R.jsx)(G.a.Column,{width:16,children:e&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Se,{user:e}),Object(R.jsx)(Le,{})]})})})})),Ve=Object(s.a)((function(){var e=F().userStore;return Object(R.jsx)(te.d,{initialValues:{email:"",password:"",error:null},onSubmit:function(t,n){var r=n.setErrors;return e.login(t).catch((function(e){return r({error:"Invalid email or password"})}))},children:function(e){var t=e.handleSubmit,n=e.isSubmitting,r=e.errors;return Object(R.jsxs)(te.c,{className:"ui form",onSubmit:t,autoComplete:"off",children:[Object(R.jsx)(u.a,{as:"h2",content:"Login to Parkedex",textAlign:"center"}),Object(R.jsx)(oe,{name:"email",placeholder:"Email"}),Object(R.jsx)(oe,{name:"password",placeholder:"Password",type:"password"}),Object(R.jsx)(te.a,{name:"error",render:function(){return Object(R.jsx)($.a,{style:{marginBottom:10},basic:!0,color:"red",content:r.error})}}),Object(R.jsx)(X.a,{loading:n,positive:!0,content:"Login",type:"submit",fluid:!0})]})}})})),Pe=n(521);function Ce(e){var t=e.errors;return Object(R.jsx)(Pe.a,{error:!0,children:t&&Object(R.jsx)(Pe.a.List,{children:t.map((function(e,t){return Object(R.jsx)(Pe.a.Item,{children:e},t)}))})})}var Me=Object(s.a)((function(){var e=F().userStore;return Object(R.jsx)(te.d,{initialValues:{displayName:"",username:"",email:"",password:"",error:null},onSubmit:function(t,n){var r=n.setErrors;return e.register(t).catch((function(e){return r({error:e})}))},validationSchema:ne.b({displayName:ne.d().required(),username:ne.d().required(),email:ne.d().required().email(),password:ne.d().required()}),children:function(e){var t=e.handleSubmit,n=e.isSubmitting,r=e.errors,i=e.isValid,a=e.dirty;return Object(R.jsxs)(te.c,{className:"ui form error",onSubmit:t,autoComplete:"off",children:[Object(R.jsx)(u.a,{as:"h2",content:"Register at Parkedex",textAlign:"center"}),Object(R.jsx)(oe,{name:"displayName",placeholder:"Display Name"}),Object(R.jsx)(oe,{name:"username",placeholder:"Username"}),Object(R.jsx)(oe,{name:"email",placeholder:"Email"}),Object(R.jsx)(oe,{name:"password",placeholder:"Password",type:"password"}),Object(R.jsx)(te.a,{name:"error",render:function(){return Object(R.jsx)(Ce,{errors:r.error})}}),Object(R.jsx)(X.a,{disabled:!i||!a||n,loading:n,positive:!0,content:"Register",type:"submit",fluid:!0})]})}})})),Ie=Object(s.a)((function(){var e=F(),t=e.userStore,n=e.modalStore;return Object(R.jsx)(l.a,{inverted:!0,textAlign:"center",vertical:!0,className:"masthead",children:Object(R.jsxs)(c.a,{text:!0,children:[Object(R.jsx)(u.a,{as:"h1",size:"huge",inverted:!0,children:"Parkedex"}),Object(R.jsx)(u.a,{as:"h2",size:"medium",style:{marginTop:10},inverted:!0,children:"Gotta Visit 'Em All!"}),t.isLoggedIn?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(u.a,{as:"h2",inverted:!0,content:"Welcome to Parkedex"}),Object(R.jsx)(X.a,{as:W.a,to:"/parks",size:"huge",inverted:!0,children:"Go to the Parks!"})]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(X.a,{onClick:function(){return n.openModal(Object(R.jsx)(Ve,{}))},size:"huge",inverted:!0,children:"Login"}),Object(R.jsx)(X.a,{onClick:function(){return n.openModal(Object(R.jsx)(Me,{}))},size:"huge",inverted:!0,children:"Register"}),Object(R.jsx)(xe.a,{}),Object(R.jsx)(u.a,{as:W.a,to:"/parks",size:"tiny",inverted:!0,children:"I just want National Park Info!"})]})]})})})),Te=Object(s.a)((function(e){var t=e.park,n=F().visitLogStore.visitLogsByPark;return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(u.a,{as:"h1",content:"Visits",textAlign:"center"}),Object(R.jsx)(xe.a,{}),n(t.id).map((function(e){return Object(R.jsx)(ke,{visitLog:e},e.id)}))]})})),De=Object(s.a)((function(){var e=F(),t=e.visitLogStore,n=e.parkStore,i=e.userStore,a=e.mapStore,s=t.loadVisitLogs,c=i.getUser,u=i.setVisitedParks,l=i.isLoggedIn,d=n.currentPark,j=n.loadPark,h=n.clearPark,b=a.mapScriptLoaded,p=Object(o.h)().id;return Object(r.useEffect)((function(){return j(p),function(){h()}}),[j,h,p]),Object(r.useEffect)((function(){null!=c&&(u(),s())}),[c,u,s]),d&&l?Object(R.jsxs)(G.a,{children:[Object(R.jsxs)(G.a.Column,{width:10,children:[Object(R.jsx)(le,{park:d}),Object(R.jsx)(Te,{park:d})]}),Object(R.jsx)(G.a.Column,{width:6,children:b&&Object(R.jsx)(me,{park:d})})]}):Object(R.jsx)(J,{content:"Loading Visit Details"})})),Ne=n(520),Ee=Object(s.a)((function(){var e=F().modalStore;return Object(R.jsx)(Ne.a,{open:e.modal.open,onClose:e.closeModal,size:"mini",children:e.modal.body})})),Ae=n(91),Fe=n(513),Re=Object(s.a)((function(){var e=F(),t=e.userStore,n=t.user,r=t.logout,i=t.isLoggedIn,a=e.modalStore;return Object(R.jsx)(je.a,{borderless:!0,fixed:"top",children:Object(R.jsxs)(c.a,{children:[Object(R.jsxs)(je.a.Item,{header:!0,as:W.a,to:"/parks",children:[Object(R.jsx)(Ae.a,{name:"tree"}),"Parkedex"]}),i?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(je.a.Item,{as:W.a,to:"/profile/".concat(null===n||void 0===n?void 0:n.displayName),children:"My Visits"}),Object(R.jsx)(je.a.Item,{position:"right",children:Object(R.jsx)(Fe.a,{position:"right",pointing:"top left",text:n.displayName,children:Object(R.jsxs)(Fe.a.Menu,{children:[Object(R.jsx)(Fe.a.Item,{as:W.a,to:"/profile/".concat(null===n||void 0===n?void 0:n.displayName),text:"My Profile",icon:"user"}),Object(R.jsx)(Fe.a.Item,{onClick:r,text:"Logout",icon:"power"})]})})})]}):Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(je.a.Item,{onClick:function(){return a.openModal(Object(R.jsx)(Ve,{}))},name:"Login",position:"right"}),Object(R.jsx)(je.a.Item,{onClick:function(){return a.openModal(Object(R.jsx)(Me,{}))},name:"Register"})]})]})})})),ze=n(283);function Be(e){var t=e.component,n=Object(ze.a)(e,["component"]),r=F().userStore.isLoggedIn;return Object(R.jsx)(o.b,Object(I.a)(Object(I.a)({},n),{},{render:function(e){return r?Object(R.jsx)(t,Object(I.a)({},e)):Object(R.jsx)(o.a,{to:"/"})}}))}var Ue=Object(s.a)((function(){var e=F(),t=e.commonStore,n=e.userStore,i=e.mapStore,a=e.visitLogStore;return Object(r.useEffect)((function(){t.token?n.getUser().then((function(){return n.setVisitedParks()})).then((function(){return a.loadVisitLogs})).finally((function(){return t.setAppLoaded()})):t.setAppLoaded()}),[t,n,a]),Object(r.useEffect)((function(){i.mapScriptLoaded||i.loadMapApi()}),[i]),t.appLoaded?Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Ee,{}),Object(R.jsx)(o.b,{exact:!0,path:"/",component:Ie}),Object(R.jsx)(o.b,{path:"/(.+)",render:function(){return Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)(Re,{}),Object(R.jsxs)(c.a,{style:{marginTop:"7em"},children:[Object(R.jsx)(o.b,{exact:!0,path:"/parks",component:be}),Object(R.jsx)(o.b,{path:"/parks/:id",component:Oe}),Object(R.jsx)(Be,{path:"/visitlog/:id",component:De}),Object(R.jsx)(Be,{path:"/profile/:username",component:we}),Object(R.jsx)(o.b,{path:"/server-error",component:z})]})]})}})]}):Object(R.jsx)(J,{content:"Loading app..."})})),qe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,531)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),i(e),a(e),s(e)}))},Ge=n(47);function He(){var e=Object(o.g)().pathname;return Object(r.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var Ke=Object(Ge.a)();a.a.render(Object(R.jsx)(A.Provider,{value:E,children:Object(R.jsxs)(o.c,{history:Ke,children:[Object(R.jsx)(He,{}),Object(R.jsx)(Ue,{})]})}),document.getElementById("root")),qe()}},[[489,1,2]]]);
//# sourceMappingURL=main.95d77d54.chunk.js.map